{
  "name": "Vulnerability Exploitation",
  "description": "Learn how to identify and exploit common vulnerabilities in web applications and servers to gain unauthorized access.",
  "type": "training",
  "category": "red-team",
  "difficulty": 2,
  "objectives": [
    {
      "description": "Perform a vulnerability scan on the target web server",
      "type": "primary",
      "points": 100,
      "completionCriteria": {
        "actionType": "scan",
        "target": "server",
        "parameters": {
          "scanType": "vulnerability"
        }
      }
    },
    {
      "description": "Exploit SQL injection vulnerability in the login form",
      "type": "primary",
      "points": 200,
      "completionCriteria": {
        "actionType": "exploit",
        "target": "webapp",
        "parameters": {
          "vulnerabilityType": "sql-injection",
          "component": "login-form"
        }
      }
    },
    {
      "description": "Gain access to user credentials database",
      "type": "primary",
      "points": 250,
      "completionCriteria": {
        "actionType": "access",
        "target": "database",
        "parameters": {
          "databaseName": "users"
        }
      }
    },
    {
      "description": "Exploit a command injection vulnerability",
      "type": "secondary",
      "points": 300,
      "completionCriteria": {
        "actionType": "exploit",
        "target": "webapp",
        "parameters": {
          "vulnerabilityType": "command-injection",
          "component": "search-function"
        }
      }
    }
  ],
  "assets": [
    {
      "name": "Vulnerable Web Server",
      "type": "server",
      "value": 3,
      "vulnerabilities": [
        "sql-injection",
        "command-injection",
        "outdated-software"
      ],
      "properties": {
        "ip": "192.168.1.20",
        "os": "Ubuntu 18.04",
        "ports": [22, 80, 443, 3306],
        "services": {
          "22": "SSH",
          "80": "HTTP (Apache 2.4.29)",
          "443": "HTTPS",
          "3306": "MySQL 5.7.32"
        }
      }
    },
    {
      "name": "Web Application",
      "type": "webapp",
      "value": 4,
      "vulnerabilities": [
        "sql-injection",
        "command-injection",
        "xss"
      ],
      "properties": {
        "url": "http://192.168.1.20/app",
        "framework": "PHP 7.2",
        "components": [
          "login-form",
          "search-function",
          "user-profile"
        ]
      }
    },
    {
      "name": "User Database",
      "type": "database",
      "value": 5,
      "vulnerabilities": [
        "weak-credentials",
        "no-encryption"
      ],
      "properties": {
        "type": "MySQL",
        "name": "users",
        "tables": ["users", "roles", "permissions"],
        "credentials": {
          "username": "dbuser",
          "password": "password123"
        }
      }
    }
  ],
  "initialState": {
    "playerAccess": {
      "ip": "192.168.1.5",
      "permissions": "user",
      "tools": ["nmap", "sqlmap", "burpsuite", "metasploit"]
    },
    "visibleAssets": ["Vulnerable Web Server"],
    "hints": [
      "Start with a vulnerability scan to identify potential weaknesses",
      "For SQL injection, try entering special characters in the login form",
      "Common SQL injection payloads include: ' OR 1=1 --",
      "For command injection, look for input fields that might execute system commands",
      "Try using tools like sqlmap for automated SQL injection testing"
    ],
    "tutorial": {
      "steps": [
        {
          "title": "Introduction to Vulnerability Exploitation",
          "content": "Vulnerability exploitation involves identifying and leveraging weaknesses in systems to gain unauthorized access or extract sensitive information."
        },
        {
          "title": "Vulnerability Scanning",
          "content": "Begin by scanning the target for known vulnerabilities. Use the 'scan' command with the 'server' target and 'vulnerability' scan type.",
          "example": "scan server --target 192.168.1.20 --type vulnerability"
        },
        {
          "title": "SQL Injection",
          "content": "SQL injection allows attackers to manipulate database queries. Try exploiting the login form with SQL injection techniques.",
          "example": "exploit webapp --target http://192.168.1.20/app --vulnerability sql-injection --component login-form"
        },
        {
          "title": "Accessing the Database",
          "content": "After successful SQL injection, attempt to access the user credentials database.",
          "example": "access database --name users"
        },
        {
          "title": "Command Injection",
          "content": "Command injection allows execution of arbitrary commands on the server. Try exploiting the search function.",
          "example": "exploit webapp --target http://192.168.1.20/app --vulnerability command-injection --component search-function"
        }
      ]
    }
  },
  "timeLimit": 45,
  "requiredSkills": ["Network Reconnaissance", "Web Application Basics", "SQL Basics"],
  "rewards": {
    "experience": 750,
    "certification": "Basic Vulnerability Exploitation"
  }
}